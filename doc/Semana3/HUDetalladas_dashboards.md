# **Historias de Usuario - M√≥dulo de Dashboard Principal**

---

## **HU-DASH-01** ‚Äî Dashboard Base (Estructura Com√∫n)

**T√≠tulo:** Interfaz base responsive con navegaci√≥n adaptada por rol

**Historia:**
> Como usuario del sistema (padre, docente, director, administrador), quiero acceder a una interfaz principal intuitiva y responsive que me permita navegar f√°cilmente entre los m√≥dulos disponibles seg√∫n mi rol.

**Criterios de Aceptaci√≥n:**

**Condiciones Funcionales:**
- **CA-01:** Dashboard se renderiza inmediatamente despu√©s de autenticaci√≥n exitosa
- **CA-02:** Estructura base incluye 3 zonas principales:
  - **Header:** Barra superior fija con identidad del usuario y acciones globales
  - **Sidebar/Navegaci√≥n:** Men√∫ lateral colapsable (desktop) o men√∫ hamburguesa (mobile)
  - **Body/Contenido:** √Årea principal din√°mica seg√∫n el m√≥dulo activo
- **CA-03:** Header debe incluir:
  - Logo institucional (I.E.P. Las Orqu√≠deas) clickeable ‚Üí vuelve al dashboard
  - Selector de hijo (solo para padres con m√∫ltiples hijos) - HU-AUTH-05
  - Icono de notificaciones con badge de cantidad no le√≠das
  - Avatar/Icono de usuario con dropdown: Ver perfil, Cerrar sesi√≥n
- **CA-04:** Sidebar debe mostrar:
  - Nombre completo del usuario + rol
  - Lista de m√≥dulos disponibles seg√∫n permisos del rol
  - √çconos claros para cada m√≥dulo
  - Indicador visual del m√≥dulo actualmente activo
- **CA-05:** Navegaci√≥n debe ser:
  - **Desktop:** Sidebar siempre visible (colapsable a modo compacto)
  - **Mobile:** Men√∫ hamburguesa que se despliega desde la izquierda

**Validaciones de Negocio:**
- **VN-01:** Mostrar solo m√≥dulos accesibles seg√∫n `usuarios.rol`
- **VN-02:** Si hay permisos granulares (docentes), filtrar opciones seg√∫n `permisos_docentes`
- **VN-03:** Validar sesi√≥n activa en cada cambio de m√≥dulo
- **VN-04:** Si token JWT expira, redirigir autom√°ticamente a login

**UI/UX:**
- **UX-01:** Dise√±o mobile-first con breakpoints:
  - Mobile: < 768px (men√∫ hamburguesa)
  - Tablet: 768px - 1024px (sidebar colapsable)
  - Desktop: > 1024px (sidebar completo)
- **UX-02:** Colores institucionales consistentes
- **UX-03:** Transiciones suaves:
  - Apertura/cierre de sidebar (300ms)
  - Cambio entre m√≥dulos (fade in/out)
- **UX-04:** Accesibilidad:
  - Contraste m√≠nimo WCAG AA
  - Navegaci√≥n por teclado (Tab, Enter)
  - Tooltips en √≠conos del sidebar colapsado
- **UX-05:** Loading states:
  - Skeleton screens al cargar contenido inicial
  - Spinners en acciones as√≠ncronas

**Estados y Flujo:**
- **EF-01:** Estado inicial: Usuario autenticado, cargando dashboard
- **EF-02:** Estado activo: Dashboard renderizado con m√≥dulo inicial
- **EF-03:** Estado de navegaci√≥n: Usuario cambia entre m√≥dulos
- **EF-04:** Estado responsive: Adaptaci√≥n seg√∫n tama√±o de pantalla

**HU Relacionadas:**
- **HU Previas:** HU-AUTH-01 (Autenticaci√≥n exitosa)
- **HU Siguientes:** HU-DASH-02 a HU-DASH-05 (Dashboards espec√≠ficos por rol)

**Componentes y Estructura:**
- **Tipo:** Layout wrapper para todas las rutas protegidas
- **Componentes principales:**
  - `DashboardLayout`: Contenedor principal con estructura fija
  - `Header`: Barra superior con acciones globales
  - `Sidebar`: Navegaci√≥n lateral con men√∫ por rol
  - `MainContent`: √Årea de contenido din√°mico
  - `NotificationBadge`: Contador de notificaciones no le√≠das
  - `UserDropdown`: Men√∫ desplegable con opciones de usuario
  - `MobileMenu`: Men√∫ hamburguesa para m√≥viles
- **Rutas protegidas:** `/dashboard/*` (requiere autenticaci√≥n)

---

## **HU-DASH-02** ‚Äî Dashboard Padre/Apoderado

**T√≠tulo:** Centro de informaci√≥n acad√©mica del estudiante seleccionado

**Historia:**
> Como padre/apoderado, quiero visualizar un resumen consolidado del desempe√±o acad√©mico de mi hijo seleccionado, con accesos r√°pidos a los m√≥dulos m√°s importantes para facilitar el seguimiento diario.

**Criterios de Aceptaci√≥n:**

**Condiciones Funcionales:**
- **CA-01:** Body del dashboard muestra 4 secciones principales:
  1. **Resumen Acad√©mico Reciente:**
     - √öltimas 5 calificaciones registradas (curso, nota, fecha)
     - Promedio general del trimestre actual
     - Toggle para cambiar entre escala num√©rica (0-20) y letras (AD/A/B/C)
  2. **Estado de Asistencia Actual:**
     - Porcentaje de asistencia del mes actual
     - √öltimos 7 d√≠as en calendario compacto con estados visuales
     - Alertas si hay faltas injustificadas recientes
  3. **Notificaciones Recientes:**
     - √öltimas 5 notificaciones (acad√©micas, comunicados, mensajes)
     - Bot√≥n "Ver todas" ‚Üí redirige a m√≥dulo de notificaciones
  4. **Accesos R√°pidos (Cards clickeables):**
     - Ver Calificaciones Completas
     - Ver Asistencia Detallada
     - Mis Mensajes
     - Comunicados Institucionales
     - Encuestas Pendientes
     - Soporte T√©cnico
- **CA-02:** Si padre tiene m√∫ltiples hijos:
  - Mostrar selector en header (HU-AUTH-05)
  - Al cambiar hijo, refrescar autom√°ticamente todo el contenido del dashboard
- **CA-03:** Si no hay datos acad√©micos a√∫n:
  - Mostrar mensaje amigable: "A√∫n no hay calificaciones/asistencia registradas"
  - Mantener accesos r√°pidos visibles

**Validaciones de Negocio:**
- **VN-01:** Mostrar solo informaci√≥n del hijo seleccionado actualmente
- **VN-02:** Filtrar por a√±o acad√©mico actual por defecto
- **VN-03:** Datos de resumen deben actualizarse en tiempo real (polling cada 5 min si est√° activo)
- **VN-04:** Solo mostrar comunicados/encuestas dirigidos al grado del hijo

**UI/UX:**
- **UX-01:** Layout en grid responsive:
  - Mobile: 1 columna (secciones apiladas)
  - Tablet: 2 columnas (2x2)
  - Desktop: 3 columnas (cards m√°s anchos para resumen)
- **UX-02:** Cards con dise√±o consistente:
  - T√≠tulo claro de la secci√≥n
  - Contenido visual (n√∫meros grandes, gr√°ficos simples)
  - Bot√≥n de acci√≥n "Ver m√°s" cuando aplique
- **UX-03:** Indicadores visuales:
  - Verde: Asistencia >90%, notas ‚â•14
  - Amarillo: Asistencia 80-90%, notas 11-13
  - Rojo: Asistencia <80%, notas <11
- **UX-04:** √çconos representativos por secci√≥n:
  - Calificaciones: üìä o medalla
  - Asistencia: üìÖ o checklist
  - Notificaciones: üîî
  - Mensajes: üí¨
- **UX-05:** Scroll suave entre secciones en mobile

**Estados y Flujo:**
- **EF-01:** Estado inicial: Cargando resumen acad√©mico del hijo seleccionado
- **EF-02:** Estado con datos: Dashboard completo con todas las secciones
- **EF-03:** Estado sin datos: Mensajes informativos en secciones vac√≠as
- **EF-04:** Estado de actualizaci√≥n: Refrescando datos al cambiar hijo

**HU Relacionadas:**
- **HU Previas:** HU-DASH-01 (Estructura base), HU-AUTH-05 (Selector de hijos)
- **HU Siguientes:** HU-02 (Calificaciones), HU-03 (Asistencia), HU-06 (Comunicados), HU-07 (Mensajer√≠a)

**Componentes y Estructura:**
- **Tipo:** Vista principal del dashboard (`/dashboard` para padres)
- **Componentes principales:**
  - `ParentDashboard`: Contenedor principal
  - `AcademicSummaryCard`: Resumen de calificaciones
  - `AttendanceSummaryCard`: Estado de asistencia
  - `RecentNotificationsCard`: √öltimas notificaciones
  - `QuickAccessGrid`: Grid de accesos r√°pidos
  - `EmptyStateMessage`: Mensaje cuando no hay datos
- **Endpoints API:**
  - `GET /students/{id}/summary` (resumen acad√©mico)
  - `GET /students/{id}/attendance/recent` (asistencia reciente)
  - `GET /notifications/recent?limit=5` (notificaciones)

---

## **HU-DASH-03** ‚Äî Dashboard Docente

**T√≠tulo:** Centro de gesti√≥n acad√©mica y comunicaci√≥n con asignaciones

**Historia:**
> Como docente, quiero visualizar mis cursos asignados y acceder r√°pidamente a las herramientas de carga de datos y comunicaci√≥n para optimizar mi flujo de trabajo diario.

**Criterios de Aceptaci√≥n:**

**Condiciones Funcionales:**
- **CA-01:** Body del dashboard muestra 3 secciones principales:
  1. **Mis Asignaciones Actuales:**
     - Lista de cursos asignados con cards:
       - Nombre del curso
       - Grado y nivel
       - N√∫mero de estudiantes
       - Bot√≥n "Cargar Datos" (redirige a m√≥dulo de datos acad√©micos pre-filtrado)
     - Filtro r√°pido por grado/nivel
  2. **Mensajes Pendientes:**
     - √öltimas 5 conversaciones con padres
     - Indicador de mensajes no le√≠dos
     - Bot√≥n "Ver todos" ‚Üí m√≥dulo de mensajer√≠a
  3. **Permisos y Herramientas:**
     - Cards condicionales seg√∫n permisos otorgados:
       - Si tiene permiso de comunicados: "Crear Comunicado" (con grados autorizados visibles)
       - Si tiene permiso de encuestas: "Crear Encuesta" (con niveles autorizados visibles)
     - Siempre visible: "Soporte T√©cnico"
- **CA-02:** Si es primer login (`debe_cambiar_password = true`):
  - Interceptar y mostrar modal de cambio de contrase√±a obligatorio (HU-AUTH-04)
- **CA-03:** Notificaci√≥n visible si hay permisos reci√©n otorgados por el director

**Validaciones de Negocio:**
- **VN-01:** Mostrar solo asignaciones del a√±o acad√©mico actual
- **VN-02:** Filtrar cursos donde `asignaciones_docente_curso.estado_activo = true`
- **VN-03:** Permisos deben validarse contra `permisos_docentes` en tiempo real
- **VN-04:** Si docente no tiene asignaciones, mostrar mensaje: "No tienes cursos asignados. Contacta al director"

**UI/UX:**
- **UX-01:** Layout en 2 columnas:
  - Columna principal (70%): Asignaciones + Mensajes
  - Columna lateral (30%): Permisos y herramientas
  - Mobile: Apilado en 1 columna
- **UX-02:** Cards de cursos con hover effects:
  - Fondo suave en hover
  - Bot√≥n "Cargar Datos" con √≠cono de upload
- **UX-03:** Badges visuales:
  - Mensajes no le√≠dos: Badge rojo con n√∫mero
  - Permisos activos: Badge verde "Autorizado"
- **UX-04:** Accesos r√°pidos con √≠conos grandes:
  - üì§ Cargar Calificaciones
  - üìã Cargar Asistencia
  - üì¢ Crear Comunicado (si tiene permiso)
  - üìä Crear Encuesta (si tiene permiso)
- **UX-05:** Filtros visuales claros con chips o tabs

**Estados y Flujo:**
- **EF-01:** Estado inicial: Cargando asignaciones y permisos del docente
- **EF-02:** Estado con asignaciones: Dashboard completo con cursos
- **EF-03:** Estado sin asignaciones: Mensaje informativo
- **EF-04:** Estado de primer login: Modal obligatorio de cambio de contrase√±a

**HU Relacionadas:**
- **HU Previas:** HU-DASH-01 (Estructura base), HU-AUTH-04 (Cambio de contrase√±a obligatorio)
- **HU Siguientes:** HU-10 (Cargar calificaciones), HU-11 (Cargar asistencia), HU-13 (Mensajer√≠a), HU-14 (Comunicados), HU-15 (Encuestas)

**Componentes y Estructura:**
- **Tipo:** Vista principal del dashboard (`/dashboard` para docentes)
- **Componentes principales:**
  - `TeacherDashboard`: Contenedor principal
  - `CourseAssignmentsGrid`: Grid de cursos asignados
  - `CourseCard`: Card individual por curso
  - `MessagesPreviewCard`: √öltimas conversaciones
  - `PermissionsPanel`: Panel lateral con permisos y herramientas
  - `QuickActionButton`: Botones de acceso r√°pido
- **Endpoints API:**
  - `GET /teachers/{id}/assignments` (asignaciones)
  - `GET /teachers/{id}/permissions` (permisos granulares)
  - `GET /conversations/recent?limit=5` (mensajes)

---

## **HU-DASH-04** ‚Äî Dashboard Director

**T√≠tulo:** Centro de supervisi√≥n y gesti√≥n institucional

**Historia:**
> Como director, quiero visualizar m√©tricas institucionales clave y acceder a herramientas de gesti√≥n y supervisi√≥n para tomar decisiones informadas sobre la operaci√≥n educativa.

**Criterios de Aceptaci√≥n:**

**Condiciones Funcionales:**
- **CA-01:** Body del dashboard muestra 4 zonas principales:
  1. **M√©tricas Institucionales (KPIs):**
     - Cards con n√∫meros grandes:
       - Total de estudiantes activos (por nivel)
       - Promedio general institucional (trimestre actual)
       - Porcentaje de asistencia institucional (mes actual)
       - Comunicados activos publicados
       - Encuestas activas con tasa de respuesta
  2. **Actividad Reciente del Sistema:**
     - Timeline de √∫ltimas 10 acciones relevantes:
       - Docente X carg√≥ calificaciones de Curso Y
       - Se public√≥ comunicado Z
       - Padre W envi√≥ mensaje sobre estudiante V
     - Filtro por tipo de actividad
  3. **Herramientas de Gesti√≥n R√°pida:**
     - Cards clickeables grandes:
       - üîë Gestionar Permisos de Docentes
       - ‚öôÔ∏è Configurar Estructura de Evaluaci√≥n
       - üìä Configurar Umbrales de Alertas
       - üëÅÔ∏è Supervisar Mensajer√≠a
       - üì¢ Crear Comunicado Institucional
       - üìã Crear Encuesta Institucional
  4. **Alertas Cr√≠ticas:**
     - Secci√≥n destacada (borde rojo/amarillo) con:
       - Estudiantes con 3+ faltas injustificadas consecutivas
       - Cursos sin calificaciones cargadas en el trimestre
       - Docentes sin actividad reciente (>15 d√≠as)

**Validaciones de Negocio:**
- **VN-01:** M√©tricas calculadas en tiempo real desde base de datos
- **VN-02:** Filtrar por a√±o acad√©mico actual
- **VN-03:** Actividad reciente solo de √∫ltimas 24-48 horas
- **VN-04:** Alertas cr√≠ticas deben actualizarse cada 5 minutos si dashboard est√° activo

**UI/UX:**
- **UX-01:** Layout en grid adaptativo:
  - Desktop: 3 columnas (KPIs | Actividad + Alertas | Herramientas)
  - Tablet: 2 columnas
  - Mobile: 1 columna apilada
- **UX-02:** KPIs con visualizaci√≥n impactante:
  - N√∫meros grandes con tendencias (‚Üë ‚Üì ‚Üí)
  - Colores seg√∫n estado (verde/amarillo/rojo)
  - Gr√°ficos simples (barras, tortas peque√±as)
- **UX-03:** Timeline de actividad con √≠conos:
  - üìö Carga acad√©mica
  - üí¨ Mensajer√≠a
  - üì¢ Comunicados
  - üìä Encuestas
- **UX-04:** Herramientas con cards grandes y coloridas:
  - Hover effect con elevaci√≥n (shadow)
  - √çconos grandes representativos
- **UX-05:** Alertas con dise√±o destacado:
  - Borde grueso coloreado
  - √çcono de advertencia ‚ö†Ô∏è
  - Bot√≥n "Ver detalle" por cada alerta

**Estados y Flujo:**
- **EF-01:** Estado inicial: Cargando m√©tricas institucionales
- **EF-02:** Estado completo: Dashboard con todas las secciones
- **EF-03:** Estado con alertas: Secci√≥n de alertas visible si existen
- **EF-04:** Estado sin alertas: Mensaje positivo "Todo en orden ‚úì"

**HU Relacionadas:**
- **HU Previas:** HU-DASH-01 (Estructura base)
- **HU Siguientes:** HU-16 (Gesti√≥n de permisos), HU-17 (Supervisi√≥n de mensajer√≠a), HU-18 (Carga de datos), HU-19 (Configuraci√≥n de evaluaci√≥n)

**Componentes y Estructura:**
- **Tipo:** Vista principal del dashboard (`/dashboard` para director)
- **Componentes principales:**
  - `DirectorDashboard`: Contenedor principal
  - `InstitutionalKPIsGrid`: Grid de m√©tricas clave
  - `ActivityTimeline`: Timeline de actividad reciente
  - `ManagementToolsGrid`: Grid de herramientas
  - `CriticalAlertsPanel`: Panel de alertas urgentes
  - `KPICard`: Card individual para cada m√©trica
  - `AlertItem`: Componente de alerta individual
- **Endpoints API:**
  - `GET /institutional/kpis` (m√©tricas institucionales)
  - `GET /activity/recent` (actividad del sistema)
  - `GET /alerts/critical` (alertas urgentes)

---

## **HU-DASH-05** ‚Äî Dashboard Administrador

**T√≠tulo:** Centro de gesti√≥n t√©cnica y soporte

**Historia:**
> Como administrador del sistema, quiero visualizar el estado t√©cnico de la plataforma y gestionar tickets de soporte para garantizar el correcto funcionamiento operativo.

**Criterios de Aceptaci√≥n:**

**Condiciones Funcionales:**
- **CA-01:** Body del dashboard muestra 3 secciones principales:
  1. **Estado del Sistema:**
     - Cards con m√©tricas t√©cnicas:
       - Usuarios activos (√∫ltima sesi√≥n < 24h)
       - Total de usuarios registrados (por rol)
       - Espacio usado en Cloudinary (archivos adjuntos)
       - Tama√±o de base de datos (PostgreSQL)
       - √öltima fecha de backup
  2. **Tickets de Soporte:**
     - Grid con tabs por estado:
       - Pendientes (badge con n√∫mero)
       - En Proceso
       - Resueltos (√∫ltimos 10)
     - Por cada ticket:
       - N√∫mero de ticket
       - Usuario solicitante + rol
       - Categor√≠a y prioridad
       - Fecha de creaci√≥n
       - Bot√≥n "Atender"
  3. **Herramientas Administrativas:**
     - Cards de acciones r√°pidas:
       - üì• Exportar Datos (CSV/SQL)
       - üîÑ Backup Manual
       - üìã Ver Logs del Sistema
       - ‚ùì Gestionar FAQ/Gu√≠as
       - üë• Ver Todos los Usuarios
- **CA-02:** Notificaci√≥n destacada si hay tickets cr√≠ticos sin atender (>4 horas)
- **CA-03:** Dashboard debe ser accesible solo con rol `administrador`

**Validaciones de Negocio:**
- **VN-01:** M√©tricas t√©cnicas actualizadas cada 5 minutos
- **VN-02:** Tickets ordenados por prioridad (cr√≠tica > alta > normal > baja)
- **VN-03:** Solo mostrar tickets del a√±o acad√©mico actual por defecto
- **VN-04:** Validar permisos de administrador en cada acci√≥n cr√≠tica

**UI/UX:**
- **UX-01:** Layout en 2 columnas:
  - Columna principal (70%): Tickets de soporte
  - Columna lateral (30%): Estado del sistema + Herramientas
  - Mobile: Apilado
- **UX-02:** Tickets con dise√±o tipo tabla compacta:
  - Colores por prioridad (rojo cr√≠tica, naranja alta, verde normal)
  - Badges de categor√≠a
  - Hover muestra preview de la descripci√≥n
- **UX-03:** Estado del sistema con √≠conos visuales:
  - ‚úÖ Verde: Todo operativo
  - ‚ö†Ô∏è Amarillo: Atenci√≥n requerida
  - ‚ùå Rojo: Problema cr√≠tico
- **UX-04:** Herramientas con √≠conos t√©cnicos:
  - üóÑÔ∏è Base de datos
  - üì¶ Archivos
  - üìä Logs
  - üõ†Ô∏è Configuraci√≥n
- **UX-05:** Filtros r√°pidos para tickets:
  - Por categor√≠a (dropdown)
  - Por prioridad (chips)
  - Por fecha de creaci√≥n (date picker)

**Estados y Flujo:**
- **EF-01:** Estado inicial: Cargando estado del sistema y tickets
- **EF-02:** Estado operativo: Dashboard completo sin alertas cr√≠ticas
- **EF-03:** Estado con alertas: Tickets cr√≠ticos destacados
- **EF-04:** Estado de mantenimiento: Mensaje si se est√° ejecutando backup

**HU Relacionadas:**
- **HU Previas:** HU-DASH-01 (Estructura base)
- **HU Siguientes:** HU-20 (Gesti√≥n de usuarios), HU-21 (Gesti√≥n de tickets), HU-22 (Exportaci√≥n de datos)

**Componentes y Estructura:**
- **Tipo:** Vista principal del dashboard (`/dashboard` para administrador)
- **Componentes principales:**
  - `AdminDashboard`: Contenedor principal
  - `SystemStatusPanel`: Panel de estado t√©cnico
  - `TicketsTable`: Tabla de tickets con tabs
  - `TicketRow`: Componente de ticket individual
  - `AdminToolsGrid`: Grid de herramientas administrativas
  - `SystemMetricCard`: Card de m√©trica t√©cnica
- **Endpoints API:**
  - `GET /system/status` (estado del sistema)
  - `GET /tickets?status={status}` (tickets por estado)
  - `GET /users/stats` (estad√≠sticas de usuarios)

---

## **Estructura de Navegaci√≥n por Rol (Sidebar)**

### **Padre/Apoderado:**
```
üè† Inicio (Dashboard)
üìä Calificaciones
üìÖ Asistencia
üí¨ Mensajes
üì¢ Comunicados
üìã Encuestas
üÜò Soporte T√©cnico
```

### **Docente:**
```
üè† Inicio (Dashboard)
üìö Mis Cursos
üì§ Cargar Datos
   ‚îú‚îÄ Calificaciones
   ‚îî‚îÄ Asistencia
üí¨ Mensajes
üì¢ Comunicados* (si tiene permiso)
üìã Encuestas* (si tiene permiso)
üÜò Soporte T√©cnico
```

### **Director:**
```
üè† Inicio (Dashboard)
üë• Gesti√≥n de Usuarios
   ‚îú‚îÄ Permisos Docentes
   ‚îî‚îÄ Ver Todos
‚öôÔ∏è Configuraci√≥n
   ‚îú‚îÄ Estructura de Evaluaci√≥n
   ‚îú‚îÄ Umbrales de Alertas
   ‚îî‚îÄ Per√≠odos Acad√©micos
üì§ Cargar Datos
   ‚îú‚îÄ Calificaciones
   ‚îî‚îÄ Asistencia
üëÅÔ∏è Supervisi√≥n
   ‚îú‚îÄ Mensajer√≠a
   ‚îî‚îÄ Actividad del Sistema
üí¨ Mensajes
üì¢ Comunicados
üìã Encuestas
```

### **Administrador:**
```
üè† Inicio (Dashboard)
üé´ Soporte T√©cnico
üë• Usuarios del Sistema
üì• Exportar Datos
üóÑÔ∏è Backups
üìã Logs del Sistema
‚ùì Gestionar Ayuda (FAQ/Gu√≠as)
‚öôÔ∏è Configuraci√≥n T√©cnica
```

---

